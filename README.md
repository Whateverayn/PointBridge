# PointBridge

[各社](#対応サイト) のポイント履歴ページからデータを抽出し, Google Apps Script 経由でスプレッドシートに集約するFirefoxアドオンです.
(ソースコードを修正すればChrome等でも動くと思いますが未検証です. 少なくとも, Releases ページにあるXPIファイルはFirefox用です.)

## インストール方法

Releases ページから最新の `xpi` ファイルをダウンロードします.
おそらく, ブラウザがアドオンを追加するか尋ねてくるので, 指示に従えばインストールできます.

## セットアップ

アドオンを使用するには, データの送信先となる GAS ウェブアプリが必要です.

1. [Google スプレッドシート](https://sheets.new) を新規作成します.
2. メニューの `拡張機能` > `Apps Script` を開きます.
3. `コード.gs` に, このリポジトリの `gas_sample/Code.js` を参考にし, お好きなコードを書きます.
4. `デプロイ` > `新しいデプロイ` をクリックします.
   - 種類の選択: ウェブアプリ
   - 説明: (なんでもいいです)
   - 次のユーザーとして実行: 自分
   - アクセスできるユーザー: 全員
5. `デプロイ` をクリックし, 表示される `ウェブアプリの URL` (`https://script.google.com/macros/s/.../exec`) をコピーします.
6. PointBridge のプリファレンスを開き, 上記URLを貼り付けて保存します.
7. スプレッドシートを操作するので権限回りの許可が必要です.
8. この辺りのことはGASの定番の話なので, 色々検索すれば出てくると思います.

## 使い方

1. [対応サイト](#対応サイト) を開きます.
2. ページ上でコンテキストメニューを開き, "ラウンチ PointBridge" を選択します.
3. ポップアップが表示され, データが抽出されます.
4. 内容を確認し, "GASへプッシュ" ボタンを押します.
5. スプレッドシートにデータが追記されます (サンプルコードの通りであれば, 重複はスキップされます)

## 対応サイト

現時点では, 以下のサイトに対応しています.

- [WESTERポイント照会](https://wester.jr-odekake.net/)
- [楽天PointClub](https://point.rakuten.co.jp/)
- [au Ponta ポータル](https://point-portal.auone.jp/)
- [Vポイント](https://mypage.tsite.jp/)

## 免責事項

本ソフトウェア (PointBridge) を使用する時点で、以下の事項に同意したものとみなします.

1. 完全な無保証

   作者は, 本ソフトウェアの使用によって生じたあらゆる損害 (直接的, 間接的, 派生的問わず) について, 一切の責任を負いません.

2. アカウントへの影響

   本ソフトウェアはDOMの内容を読み取るだけのものですが, 対象サイトの利用規約やシステム側の検知により, 万が一アカウントがBAN (利用停止) されたとしても, 作者は一切関知せず, 責任を負いません.
   自己責任で使用してください.

3. データの保全

   - Google Apps Script のエンドポイント設定ミスによるデータ消失
   - スプレッドシートの内容が意図せず書き換わってしまった場合
   - GASのエンドポイントが第三者に知られ, 不正なデータが送信された場合

   上記を含むいかなるデータトラブルについても, 作者は責任を負いません.

4. コードの改変, フォーク

   本ソフトウェアをフォーク, 改変, 再配布することは自由ですが, それによって生じた結果についても, 元コードの作者は一切の責任を負いません
   (たとえ元コードに起因するバグであったとしても同様です).

5. 規約の変更

   この免責事項やポリシーは, 作者の判断により予告なく変更される場合があります.

要するに, 何が起きても全て使用者の責任だということです.

## 各サイト運営者様へ (技術的な動作について)

本ソフトウェアは, ユーザの利便性向上 (表計算ソフトへの転記作業の省力化など) を目的として作成されたブラウザ拡張機能です.
ご懸念を抱かれる可能性のある点について, 技術的な動作を説明いたします.

1. 自動操作の不在

   本ソフトウェアは, ユーザが手動で開いたページに対してのみ動作します.
   自動でページを巡回したり, 貴社サーバへ追加のリクエストを送信する機能はありません.

2. サーバ負荷への配慮

   本ソフトウェアは, ブラウザに既に表示されている内容 (DOM) を読み取っているだけです. 
   データの取得のために, 貴社サーバへ追加の通信を行うことはありません.
   (ユーザが通常通り閲覧する以上の負荷をかけることはありません)

3. サイト表示への影響

   UIの表示には Shadow DOM (カプセル化された領域) を使用しており, 元のページのレイアウトやスタイルへの干渉を極力避ける設計となっています.
   これは多くの一般的なブラウザ拡張機能 (翻訳ツールなど) と同様の仕組みです.

万が一, 本ソフトウェアの公開等が貴社の不利益になる場合は, GitHubの Issue 等でご連絡いただければ検討いたします.

